# Redirect HTTP to HTTPS
server {
    listen 80;
    server_name kadea-kin.com www.kadea-kin.com;
    # Permanently redirect all HTTP traffic to the secure HTTPS version
    return 301 https://$host$request_uri;
}

# HTTPS Server Block
server {
    # Listen on port 443 with the 'ssl' parameter enabled
    listen 443 ssl;
    server_name kadea-kin.com www.kadea-kin.com;

    # Specify the paths to your SSL certificate and private key
    # You can obtain free certificates from a CA like Let's Encrypt
    ssl_certificate /etc/nginx/ssl/fullchain.pem;       # Path to full certificate chain
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;    # Path to private key

    # --- Security Enhancements ---

    # Enforce strong TLS versions and disable weak ones
    ssl_protocols TLSv1.2 TLSv1.3;

    # Use a secure list of cipher suites
    # The default ciphers are generally secure enough in modern NGINX versions
    # ssl_ciphers HIGH:!aNULL:!MD5; 

    # Enable HTTP Strict Transport Security (HSTS) to force browsers to use HTTPS
    # max-age is set for 1 year; includeSubDomains is optional
    #add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

    # HSTS for 2025: 2-year duration, includes all subdomains, and preloading enabled
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
 
    # Block clickjacking attempts
    add_header X-Frame-Options "SAMEORIGIN";

    # Stop MIME type sniffing
    add_header X-Content-Type-Options "nosniff";

    # Set client body and header buffer sizes for basic security hardening
    client_body_buffer_size 1k;
    client_header_buffer_size 1k;
    client_max_body_size 1k;


    # Location block for handling requests (e.g., serving files or proxying)
    location / {
        # Example for serving static files
        root /var/www/html;
        index index.html index.htm;
        
        # Example for proxying to a backend server (if used)
        # proxy_pass http://localhost:8000;
        # proxy_set_header Host $host;
        # proxy_set_header X-Real-IP $remote_addr;
        # proxy_set_header X-Forwarded-Proto https;
    }
}
